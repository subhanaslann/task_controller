{
  "backend_testing_prompt": {
    "project_name": "Multi-Tenant Task Tracker Backend",
    "description": "Comprehensive backend testing specification for a multi-tenant task management system with organization isolation, role-based access control (ADMIN, TEAM_MANAGER, MEMBER, GUEST), and topic-based task categorization.",
    "technology_stack": {
      "runtime": "Node.js",
      "framework": "Express.js",
      "orm": "Prisma",
      "database": "SQLite (dev) / PostgreSQL-compatible",
      "authentication": "JWT",
      "validation": "Zod",
      "security": ["helmet", "bcrypt", "cors", "rate-limiting"]
    },
    "base_url": "http://localhost:8080",
    "test_environment": {
      "setup_commands": [
        "cd server",
        "npm install",
        "npm run prisma:generate",
        "npm run prisma:migrate",
        "npm run prisma:seed",
        "npm run dev"
      ],
      "seed_data": {
        "organizations": [
          {
            "name": "Acme Corporation",
            "team_name": "Engineering Team",
            "slug": "acme-engineering",
            "users": [
              {"email": "john@acme.com", "password": "manager123", "role": "TEAM_MANAGER", "name": "John Manager"},
              {"email": "alice@acme.com", "password": "member123", "role": "MEMBER", "name": "Alice Johnson"},
              {"email": "bob@acme.com", "password": "member123", "role": "MEMBER", "name": "Bob Smith"},
              {"email": "charlie@acme.com", "password": "guest123", "role": "GUEST", "name": "Charlie Guest"}
            ],
            "topics": [
              {"title": "Backend Development", "description": "API and database development tasks"},
              {"title": "Frontend Development", "description": "UI/UX and client-side development"}
            ],
            "tasks": 3
          },
          {
            "name": "Tech Startup Inc",
            "team_name": "Product Team",
            "slug": "tech-startup-product",
            "users": [
              {"email": "sarah@techstartup.com", "password": "manager123", "role": "TEAM_MANAGER", "name": "Sarah Manager"},
              {"email": "david@techstartup.com", "password": "member123", "role": "MEMBER", "name": "David Developer"},
              {"email": "emma@techstartup.com", "password": "member123", "role": "MEMBER", "name": "Emma Engineer"},
              {"email": "frank@consultant.com", "password": "guest123", "role": "GUEST", "name": "Frank Consultant"}
            ],
            "topics": [
              {"title": "Mobile App Development", "description": "iOS and Android app development"},
              {"title": "DevOps", "description": "Infrastructure and deployment"}
            ],
            "tasks": 4
          },
          {
            "name": "Design Agency",
            "team_name": "Creative Team",
            "slug": "design-agency-creative",
            "users": [
              {"email": "lisa@designagency.com", "password": "manager123", "role": "TEAM_MANAGER", "name": "Lisa Designer"},
              {"email": "mark@designagency.com", "password": "member123", "role": "MEMBER", "name": "Mark Creative"}
            ],
            "topics": [
              {"title": "Client Projects", "description": "Active client design projects"}
            ],
            "tasks": 1
          }
        ]
      }
    },
    "testing_categories": [
      {
        "category": "1. Health & Infrastructure",
        "priority": "HIGH",
        "description": "Verify server health, database connectivity, and basic infrastructure",
        "tests": [
          {
            "test_id": "HEALTH_01",
            "name": "Health Check Endpoint",
            "method": "GET",
            "endpoint": "/health",
            "authentication": "none",
            "expected_status": 200,
            "expected_response": {
              "status": "healthy",
              "database": "connected",
              "timestamp": "<ISO_DATE>",
              "environment": "development",
              "uptime": "<NUMBER>",
              "memory": {
                "used": "<NUMBER>",
                "total": "<NUMBER>"
              },
              "organizations": "<NUMBER>",
              "activeOrganizations": "<NUMBER>"
            },
            "validation_rules": [
              "Response contains 'status' field with value 'healthy'",
              "Database field shows 'connected'",
              "Organizations count is >= 3",
              "Response time < 500ms"
            ]
          }
        ]
      },
      {
        "category": "2. Authentication & Registration",
        "priority": "CRITICAL",
        "description": "Test user authentication, JWT token generation, and team registration",
        "tests": [
          {
            "test_id": "AUTH_01",
            "name": "Login with Email (Team Manager)",
            "method": "POST",
            "endpoint": "/auth/login",
            "authentication": "none",
            "request_body": {
              "usernameOrEmail": "john@acme.com",
              "password": "manager123"
            },
            "expected_status": 200,
            "expected_response": {
              "token": "<JWT_TOKEN>",
              "user": {
                "id": "<UUID>",
                "organizationId": "<UUID>",
                "name": "John Manager",
                "username": "john",
                "email": "john@acme.com",
                "role": "TEAM_MANAGER",
                "active": true,
                "createdAt": "<ISO_DATE>",
                "updatedAt": "<ISO_DATE>"
              },
              "organization": {
                "id": "<UUID>",
                "name": "Acme Corporation",
                "teamName": "Engineering Team",
                "slug": "acme-engineering",
                "isActive": true,
                "maxUsers": 15,
                "createdAt": "<ISO_DATE>",
                "updatedAt": "<ISO_DATE>"
              }
            },
            "validation_rules": [
              "JWT token is present and valid",
              "Token contains: userId, organizationId, role, email",
              "User role is TEAM_MANAGER",
              "Organization details are included",
              "Password is NOT in response"
            ],
            "save_variables": {
              "acme_manager_token": "response.token",
              "acme_manager_id": "response.user.id",
              "acme_org_id": "response.organization.id"
            }
          },
          {
            "test_id": "AUTH_02",
            "name": "Login with Username (Member)",
            "method": "POST",
            "endpoint": "/auth/login",
            "request_body": {
              "usernameOrEmail": "alice",
              "password": "member123"
            },
            "expected_status": 200,
            "validation_rules": [
              "Login succeeds with username instead of email",
              "User role is MEMBER",
              "Organization matches Acme Corporation"
            ],
            "save_variables": {
              "acme_member_token": "response.token",
              "acme_member_id": "response.user.id"
            }
          },
          {
            "test_id": "AUTH_03",
            "name": "Login as Guest User",
            "method": "POST",
            "endpoint": "/auth/login",
            "request_body": {
              "usernameOrEmail": "charlie@acme.com",
              "password": "guest123"
            },
            "expected_status": 200,
            "validation_rules": [
              "User role is GUEST",
              "Token is valid"
            ],
            "save_variables": {
              "acme_guest_token": "response.token",
              "acme_guest_id": "response.user.id"
            }
          },
          {
            "test_id": "AUTH_04",
            "name": "Login from Different Organization",
            "method": "POST",
            "endpoint": "/auth/login",
            "request_body": {
              "usernameOrEmail": "sarah@techstartup.com",
              "password": "manager123"
            },
            "expected_status": 200,
            "validation_rules": [
              "User belongs to Tech Startup Inc organization",
              "organizationId is different from Acme Corporation",
              "Token contains correct organizationId"
            ],
            "save_variables": {
              "tech_manager_token": "response.token",
              "tech_org_id": "response.organization.id"
            }
          },
          {
            "test_id": "AUTH_05",
            "name": "Login with Invalid Credentials",
            "method": "POST",
            "endpoint": "/auth/login",
            "request_body": {
              "usernameOrEmail": "john@acme.com",
              "password": "wrongpassword"
            },
            "expected_status": 401,
            "validation_rules": [
              "Returns 401 Unauthorized",
              "Error message indicates invalid credentials",
              "No token is returned"
            ]
          },
          {
            "test_id": "AUTH_06",
            "name": "Login with Non-existent User",
            "method": "POST",
            "endpoint": "/auth/login",
            "request_body": {
              "usernameOrEmail": "nonexistent@example.com",
              "password": "password123"
            },
            "expected_status": 401,
            "validation_rules": [
              "Returns 401 Unauthorized",
              "Error message does not reveal user existence"
            ]
          },
          {
            "test_id": "REG_01",
            "name": "Register New Team",
            "method": "POST",
            "endpoint": "/auth/register",
            "request_body": {
              "companyName": "New Startup LLC",
              "teamName": "Development",
              "managerName": "Jane Smith",
              "email": "jane@newstartup.com",
              "password": "SecurePass123"
            },
            "expected_status": 201,
            "expected_response": {
              "message": "Team registered successfully",
              "data": {
                "organization": {
                  "id": "<UUID>",
                  "name": "New Startup LLC",
                  "teamName": "Development",
                  "slug": "<STRING>",
                  "isActive": true,
                  "maxUsers": 15
                },
                "user": {
                  "id": "<UUID>",
                  "name": "Jane Smith",
                  "email": "jane@newstartup.com",
                  "role": "TEAM_MANAGER",
                  "active": true
                },
                "token": "<JWT_TOKEN>"
              }
            },
            "validation_rules": [
              "Organization is created with unique slug",
              "User is created as TEAM_MANAGER",
              "JWT token is returned",
              "maxUsers defaults to 15",
              "Organization is active by default",
              "Email is unique across all organizations"
            ],
            "save_variables": {
              "new_org_id": "response.data.organization.id",
              "new_manager_token": "response.data.token"
            }
          },
          {
            "test_id": "REG_02",
            "name": "Register with Duplicate Email",
            "method": "POST",
            "endpoint": "/auth/register",
            "request_body": {
              "companyName": "Another Company",
              "teamName": "Another Team",
              "managerName": "John Doe",
              "email": "john@acme.com",
              "password": "password123"
            },
            "expected_status": 400,
            "validation_rules": [
              "Returns 400 Bad Request",
              "Error message indicates email already exists"
            ]
          },
          {
            "test_id": "REG_03",
            "name": "Register with Invalid Password",
            "method": "POST",
            "endpoint": "/auth/register",
            "request_body": {
              "companyName": "Test Company",
              "teamName": "Test Team",
              "managerName": "Test User",
              "email": "test@test.com",
              "password": "short"
            },
            "expected_status": 400,
            "validation_rules": [
              "Returns 400 Bad Request",
              "Error indicates password too short (min 8 chars)"
            ]
          }
        ]
      },
      {
        "category": "3. Organization Management",
        "priority": "HIGH",
        "description": "Test organization CRUD operations, statistics, and multi-tenant isolation",
        "tests": [
          {
            "test_id": "ORG_01",
            "name": "Get Current Organization",
            "method": "GET",
            "endpoint": "/organization",
            "authentication": "bearer",
            "token_variable": "acme_manager_token",
            "expected_status": 200,
            "expected_response": {
              "message": "Organization retrieved successfully",
              "data": {
                "id": "<UUID>",
                "name": "Acme Corporation",
                "teamName": "Engineering Team",
                "slug": "acme-engineering",
                "isActive": true,
                "maxUsers": 15,
                "createdAt": "<ISO_DATE>",
                "updatedAt": "<ISO_DATE>"
              }
            },
            "validation_rules": [
              "Returns authenticated user's organization",
              "All organization fields are present"
            ]
          },
          {
            "test_id": "ORG_02",
            "name": "Update Organization (Team Manager)",
            "method": "PATCH",
            "endpoint": "/organization",
            "authentication": "bearer",
            "token_variable": "acme_manager_token",
            "request_body": {
              "name": "Acme Corporation Updated",
              "teamName": "Engineering Team v2",
              "maxUsers": 20
            },
            "expected_status": 200,
            "validation_rules": [
              "Organization name is updated",
              "Team name is updated",
              "maxUsers is updated to 20",
              "Response contains updated organization"
            ]
          },
          {
            "test_id": "ORG_03",
            "name": "Update Organization (Member - Should Fail)",
            "method": "PATCH",
            "endpoint": "/organization",
            "authentication": "bearer",
            "token_variable": "acme_member_token",
            "request_body": {
              "name": "Unauthorized Update"
            },
            "expected_status": 403,
            "validation_rules": [
              "Returns 403 Forbidden",
              "Member cannot update organization"
            ]
          },
          {
            "test_id": "ORG_04",
            "name": "Get Organization Statistics",
            "method": "GET",
            "endpoint": "/organization/stats",
            "authentication": "bearer",
            "token_variable": "acme_manager_token",
            "expected_status": 200,
            "expected_response": {
              "message": "Organization statistics retrieved successfully",
              "data": {
                "userCount": "<NUMBER>",
                "activeUserCount": "<NUMBER>",
                "taskCount": "<NUMBER>",
                "activeTaskCount": "<NUMBER>",
                "completedTaskCount": "<NUMBER>",
                "topicCount": "<NUMBER>",
                "activeTopicCount": "<NUMBER>"
              }
            },
            "validation_rules": [
              "All counts are non-negative numbers",
              "userCount >= activeUserCount",
              "taskCount >= activeTaskCount + completedTaskCount",
              "topicCount >= activeTopicCount"
            ]
          },
          {
            "test_id": "ORG_05",
            "name": "Organization Isolation - Cannot Access Other Org Stats",
            "method": "GET",
            "endpoint": "/organization/stats",
            "authentication": "bearer",
            "token_variable": "tech_manager_token",
            "expected_status": 200,
            "validation_rules": [
              "Returns statistics for Tech Startup Inc only",
              "Statistics differ from Acme Corporation",
              "No data leakage between organizations"
            ]
          }
        ]
      },
      {
        "category": "4. User Management",
        "priority": "HIGH",
        "description": "Test user CRUD operations, role-based access, and user limits",
        "tests": [
          {
            "test_id": "USER_01",
            "name": "List All Users (Team Manager)",
            "method": "GET",
            "endpoint": "/users",
            "authentication": "bearer",
            "token_variable": "acme_manager_token",
            "expected_status": 200,
            "expected_response": {
              "users": "<ARRAY>"
            },
            "validation_rules": [
              "Returns array of users",
              "All users belong to same organization",
              "User count matches organization (4 for Acme)",
              "No users from other organizations"
            ]
          },
          {
            "test_id": "USER_02",
            "name": "List Users (Member - Should Fail)",
            "method": "GET",
            "endpoint": "/users",
            "authentication": "bearer",
            "token_variable": "acme_member_token",
            "expected_status": 403,
            "validation_rules": [
              "Returns 403 Forbidden",
              "Members cannot list users"
            ]
          },
          {
            "test_id": "USER_03",
            "name": "Create New User (Team Manager)",
            "method": "POST",
            "endpoint": "/users",
            "authentication": "bearer",
            "token_variable": "acme_manager_token",
            "request_body": {
              "name": "New Member",
              "username": "newmember",
              "email": "newmember@acme.com",
              "password": "password123",
              "role": "MEMBER",
              "active": true
            },
            "expected_status": 201,
            "expected_response": {
              "user": {
                "id": "<UUID>",
                "name": "New Member",
                "username": "newmember",
                "email": "newmember@acme.com",
                "role": "MEMBER",
                "active": true,
                "organizationId": "<UUID>"
              }
            },
            "validation_rules": [
              "User is created successfully",
              "User belongs to same organization as manager",
              "Password is hashed (not in response)",
              "Username is unique within organization"
            ],
            "save_variables": {
              "new_user_id": "response.user.id"
            }
          },
          {
            "test_id": "USER_04",
            "name": "Team Manager Cannot Create ADMIN",
            "method": "POST",
            "endpoint": "/users",
            "authentication": "bearer",
            "token_variable": "acme_manager_token",
            "request_body": {
              "name": "Wannabe Admin",
              "username": "adminwannabe",
              "email": "admin@acme.com",
              "password": "password123",
              "role": "ADMIN",
              "active": true
            },
            "expected_status": 403,
            "validation_rules": [
              "Returns 403 Forbidden",
              "Team Manager cannot create ADMIN users"
            ]
          },
          {
            "test_id": "USER_05",
            "name": "Team Manager Cannot Create Other Team Managers",
            "method": "POST",
            "endpoint": "/users",
            "authentication": "bearer",
            "token_variable": "acme_manager_token",
            "request_body": {
              "name": "Another Manager",
              "username": "manager2",
              "email": "manager2@acme.com",
              "password": "password123",
              "role": "TEAM_MANAGER",
              "active": true
            },
            "expected_status": 403,
            "validation_rules": [
              "Returns 403 Forbidden",
              "Team Manager cannot create other TEAM_MANAGER users"
            ]
          },
          {
            "test_id": "USER_06",
            "name": "Update User (Deactivate)",
            "method": "PATCH",
            "endpoint": "/users/{new_user_id}",
            "authentication": "bearer",
            "token_variable": "acme_manager_token",
            "request_body": {
              "active": false
            },
            "expected_status": 200,
            "validation_rules": [
              "User is deactivated",
              "User still exists (soft delete)"
            ]
          },
          {
            "test_id": "USER_07",
            "name": "Update User Role",
            "method": "PATCH",
            "endpoint": "/users/{new_user_id}",
            "authentication": "bearer",
            "token_variable": "acme_manager_token",
            "request_body": {
              "role": "GUEST"
            },
            "expected_status": 200,
            "validation_rules": [
              "User role is updated to GUEST",
              "User remains in same organization"
            ]
          },
          {
            "test_id": "USER_08",
            "name": "Get User by ID",
            "method": "GET",
            "endpoint": "/users/{new_user_id}",
            "authentication": "bearer",
            "token_variable": "acme_manager_token",
            "expected_status": 200,
            "validation_rules": [
              "Returns user details",
              "User belongs to correct organization"
            ]
          },
          {
            "test_id": "USER_09",
            "name": "Cross-Organization Access Prevention",
            "method": "GET",
            "endpoint": "/users/{acme_member_id}",
            "authentication": "bearer",
            "token_variable": "tech_manager_token",
            "expected_status": 404,
            "validation_rules": [
              "Returns 404 Not Found",
              "Tech Startup manager cannot access Acme users",
              "Organization isolation is enforced"
            ]
          },
          {
            "test_id": "USER_10",
            "name": "Delete User",
            "method": "DELETE",
            "endpoint": "/users/{new_user_id}",
            "authentication": "bearer",
            "token_variable": "acme_manager_token",
            "expected_status": 200,
            "validation_rules": [
              "User is deleted successfully",
              "Returns success response"
            ]
          },
          {
            "test_id": "USER_11",
            "name": "Enforce User Limit (15 max)",
            "method": "POST",
            "endpoint": "/users",
            "authentication": "bearer",
            "token_variable": "acme_manager_token",
            "description": "Create users until limit is reached, then verify rejection",
            "expected_status": 400,
            "validation_rules": [
              "Returns 400 when user limit reached",
              "Error message indicates limit exceeded",
              "Limit is enforced per organization (15 users)"
            ]
          }
        ]
      },
      {
        "category": "5. Topic Management",
        "priority": "MEDIUM",
        "description": "Test topic CRUD operations and guest access control",
        "tests": [
          {
            "test_id": "TOPIC_01",
            "name": "Get Active Topics (Member)",
            "method": "GET",
            "endpoint": "/topics/active",
            "authentication": "bearer",
            "token_variable": "acme_member_token",
            "expected_status": 200,
            "expected_response": {
              "topics": "<ARRAY>"
            },
            "validation_rules": [
              "Returns array of active topics",
              "Topics belong to user's organization",
              "Includes tasks in topics",
              "Member sees all active topics"
            ]
          },
          {
            "test_id": "TOPIC_02",
            "name": "Get Active Topics (Guest - Filtered)",
            "method": "GET",
            "endpoint": "/topics/active",
            "authentication": "bearer",
            "token_variable": "acme_guest_token",
            "expected_status": 200,
            "validation_rules": [
              "Returns only topics guest has access to",
              "Guest sees limited topics (based on GuestTopicAccess)",
              "Topics are filtered by organization and permissions"
            ]
          },
          {
            "test_id": "TOPIC_03",
            "name": "List All Topics (Team Manager)",
            "method": "GET",
            "endpoint": "/admin/topics",
            "authentication": "bearer",
            "token_variable": "acme_manager_token",
            "expected_status": 200,
            "validation_rules": [
              "Returns all topics (active and inactive)",
              "Topics belong to manager's organization only",
              "No topics from other organizations"
            ],
            "save_variables": {
              "acme_topic_id": "response.topics[0].id"
            }
          },
          {
            "test_id": "TOPIC_04",
            "name": "Create New Topic",
            "method": "POST",
            "endpoint": "/admin/topics",
            "authentication": "bearer",
            "token_variable": "acme_manager_token",
            "request_body": {
              "title": "Testing & QA",
              "description": "Quality assurance and testing tasks",
              "isActive": true
            },
            "expected_status": 201,
            "expected_response": {
              "topic": {
                "id": "<UUID>",
                "organizationId": "<UUID>",
                "title": "Testing & QA",
                "description": "Quality assurance and testing tasks",
                "isActive": true,
                "createdAt": "<ISO_DATE>",
                "updatedAt": "<ISO_DATE>"
              }
            },
            "validation_rules": [
              "Topic is created successfully",
              "Topic belongs to manager's organization",
              "isActive defaults to true if not specified"
            ],
            "save_variables": {
              "new_topic_id": "response.topic.id"
            }
          },
          {
            "test_id": "TOPIC_05",
            "name": "Get Topic by ID",
            "method": "GET",
            "endpoint": "/admin/topics/{acme_topic_id}",
            "authentication": "bearer",
            "token_variable": "acme_manager_token",
            "expected_status": 200,
            "validation_rules": [
              "Returns topic details",
              "Topic belongs to correct organization"
            ]
          },
          {
            "test_id": "TOPIC_06",
            "name": "Update Topic",
            "method": "PATCH",
            "endpoint": "/admin/topics/{new_topic_id}",
            "authentication": "bearer",
            "token_variable": "acme_manager_token",
            "request_body": {
              "title": "Testing & Quality Assurance",
              "description": "Updated description",
              "isActive": false
            },
            "expected_status": 200,
            "validation_rules": [
              "Topic is updated successfully",
              "Changes are reflected in response"
            ]
          },
          {
            "test_id": "TOPIC_07",
            "name": "Delete Topic",
            "method": "DELETE",
            "endpoint": "/admin/topics/{new_topic_id}",
            "authentication": "bearer",
            "token_variable": "acme_manager_token",
            "expected_status": 200,
            "validation_rules": [
              "Topic is deleted successfully",
              "Returns success response"
            ]
          },
          {
            "test_id": "TOPIC_08",
            "name": "Cross-Organization Topic Access Prevention",
            "method": "GET",
            "endpoint": "/admin/topics/{acme_topic_id}",
            "authentication": "bearer",
            "token_variable": "tech_manager_token",
            "expected_status": 404,
            "validation_rules": [
              "Returns 404 Not Found",
              "Tech Startup manager cannot access Acme topics"
            ]
          },
          {
            "test_id": "TOPIC_09",
            "name": "Member Cannot Manage Topics",
            "method": "POST",
            "endpoint": "/admin/topics",
            "authentication": "bearer",
            "token_variable": "acme_member_token",
            "request_body": {
              "title": "Unauthorized Topic"
            },
            "expected_status": 403,
            "validation_rules": [
              "Returns 403 Forbidden",
              "Members cannot create topics"
            ]
          }
        ]
      },
      {
        "category": "6. Task Management - Member Operations",
        "priority": "CRITICAL",
        "description": "Test task CRUD operations for regular members",
        "tests": [
          {
            "test_id": "TASK_01",
            "name": "Get My Active Tasks",
            "method": "GET",
            "endpoint": "/tasks/view?scope=my_active",
            "authentication": "bearer",
            "token_variable": "acme_member_token",
            "expected_status": 200,
            "expected_response": {
              "tasks": "<ARRAY>"
            },
            "validation_rules": [
              "Returns tasks assigned to current user",
              "Tasks have status TODO or IN_PROGRESS",
              "All tasks belong to user's organization",
              "Does not include DONE tasks",
              "Includes assignee and topic details"
            ]
          },
          {
            "test_id": "TASK_02",
            "name": "Get Team Active Tasks",
            "method": "GET",
            "endpoint": "/tasks/view?scope=team_active",
            "authentication": "bearer",
            "token_variable": "acme_member_token",
            "expected_status": 200,
            "validation_rules": [
              "Returns all active tasks in organization",
              "Tasks have status TODO or IN_PROGRESS",
              "Includes tasks assigned to other members",
              "All tasks belong to same organization"
            ]
          },
          {
            "test_id": "TASK_03",
            "name": "Get Team Active Tasks (Guest - Limited Fields)",
            "method": "GET",
            "endpoint": "/tasks/view?scope=team_active",
            "authentication": "bearer",
            "token_variable": "acme_guest_token",
            "expected_status": 200,
            "validation_rules": [
              "Returns tasks with limited fields",
              "Guest sees only: id, title, status, priority, dueDate, assignee.name",
              "Sensitive fields are filtered out (note, username, etc.)",
              "Only tasks from accessible topics are shown"
            ]
          },
          {
            "test_id": "TASK_04",
            "name": "Get My Completed Tasks",
            "method": "GET",
            "endpoint": "/tasks/view?scope=my_done",
            "authentication": "bearer",
            "token_variable": "acme_member_token",
            "expected_status": 200,
            "validation_rules": [
              "Returns only completed tasks (status = DONE)",
              "Tasks are assigned to current user",
              "Includes completedAt timestamp",
              "All tasks belong to user's organization"
            ]
          },
          {
            "test_id": "TASK_05",
            "name": "Create Task as Member",
            "method": "POST",
            "endpoint": "/tasks",
            "authentication": "bearer",
            "token_variable": "acme_member_token",
            "request_body": {
              "topicId": "{acme_topic_id}",
              "title": "Implement user authentication",
              "note": "Add JWT-based authentication",
              "status": "TODO",
              "priority": "HIGH",
              "dueDate": "2025-12-31T23:59:59.000Z"
            },
            "expected_status": 201,
            "expected_response": {
              "task": {
                "id": "<UUID>",
                "organizationId": "<UUID>",
                "topicId": "<UUID>",
                "title": "Implement user authentication",
                "note": "Add JWT-based authentication",
                "assigneeId": "<UUID>",
                "status": "TODO",
                "priority": "HIGH",
                "dueDate": "<ISO_DATE>",
                "createdAt": "<ISO_DATE>",
                "updatedAt": "<ISO_DATE>",
                "completedAt": null
              }
            },
            "validation_rules": [
              "Task is created successfully",
              "Task is auto-assigned to creating member",
              "Task belongs to member's organization",
              "Status defaults to TODO if not specified",
              "Priority defaults to NORMAL if not specified"
            ],
            "save_variables": {
              "member_task_id": "response.task.id"
            }
          },
          {
            "test_id": "TASK_06",
            "name": "Update Task Status (Own Task)",
            "method": "PATCH",
            "endpoint": "/tasks/{member_task_id}/status",
            "authentication": "bearer",
            "token_variable": "acme_member_token",
            "request_body": {
              "status": "IN_PROGRESS"
            },
            "expected_status": 200,
            "validation_rules": [
              "Task status is updated to IN_PROGRESS",
              "updatedAt timestamp is changed",
              "Member can update own task"
            ]
          },
          {
            "test_id": "TASK_07",
            "name": "Update Task Status to DONE",
            "method": "PATCH",
            "endpoint": "/tasks/{member_task_id}/status",
            "authentication": "bearer",
            "token_variable": "acme_member_token",
            "request_body": {
              "status": "DONE"
            },
            "expected_status": 200,
            "validation_rules": [
              "Task status is updated to DONE",
              "completedAt timestamp is set automatically"
            ]
          },
          {
            "test_id": "TASK_08",
            "name": "Update Own Task (Full Update)",
            "method": "PATCH",
            "endpoint": "/tasks/{member_task_id}",
            "authentication": "bearer",
            "token_variable": "acme_member_token",
            "request_body": {
              "title": "Updated title",
              "note": "Updated note",
              "priority": "LOW",
              "status": "TODO"
            },
            "expected_status": 200,
            "validation_rules": [
              "Task is updated successfully",
              "Changes are reflected in response",
              "Member can update own task details"
            ]
          },
          {
            "test_id": "TASK_09",
            "name": "Member Cannot Update Other's Task",
            "method": "PATCH",
            "endpoint": "/tasks/{member_task_id}",
            "authentication": "bearer",
            "token_variable": "tech_manager_token",
            "request_body": {
              "title": "Unauthorized update"
            },
            "expected_status": 404,
            "validation_rules": [
              "Returns 404 Not Found",
              "Member from different org cannot access task",
              "Organization isolation is enforced"
            ]
          },
          {
            "test_id": "TASK_10",
            "name": "Delete Own Task",
            "method": "DELETE",
            "endpoint": "/tasks/{member_task_id}",
            "authentication": "bearer",
            "token_variable": "acme_member_token",
            "expected_status": 200,
            "validation_rules": [
              "Task is deleted successfully",
              "Member can delete own task"
            ]
          },
          {
            "test_id": "TASK_11",
            "name": "Guest Cannot Create Task",
            "method": "POST",
            "endpoint": "/tasks",
            "authentication": "bearer",
            "token_variable": "acme_guest_token",
            "request_body": {
              "title": "Guest task attempt"
            },
            "expected_status": 403,
            "validation_rules": [
              "Returns 403 Forbidden",
              "Guests cannot create tasks"
            ]
          },
          {
            "test_id": "TASK_12",
            "name": "Guest Cannot Update Task",
            "method": "PATCH",
            "endpoint": "/tasks/{member_task_id}/status",
            "authentication": "bearer",
            "token_variable": "acme_guest_token",
            "request_body": {
              "status": "IN_PROGRESS"
            },
            "expected_status": 403,
            "validation_rules": [
              "Returns 403 Forbidden",
              "Guests cannot update tasks"
            ]
          }
        ]
      },
      {
        "category": "7. Task Management - Admin Operations",
        "priority": "HIGH",
        "description": "Test admin/team manager task management capabilities",
        "tests": [
          {
            "test_id": "ADMIN_TASK_01",
            "name": "List All Tasks (Team Manager)",
            "method": "GET",
            "endpoint": "/admin/tasks",
            "authentication": "bearer",
            "token_variable": "acme_manager_token",
            "expected_status": 200,
            "validation_rules": [
              "Returns all tasks in organization",
              "Includes tasks with all statuses",
              "All tasks belong to manager's organization",
              "No tasks from other organizations"
            ]
          },
          {
            "test_id": "ADMIN_TASK_02",
            "name": "Create Task and Assign to Other User",
            "method": "POST",
            "endpoint": "/admin/tasks",
            "authentication": "bearer",
            "token_variable": "acme_manager_token",
            "request_body": {
              "topicId": "{acme_topic_id}",
              "title": "Code review required",
              "note": "Review pull request #123",
              "assigneeId": "{acme_member_id}",
              "status": "TODO",
              "priority": "NORMAL",
              "dueDate": "2025-11-20T00:00:00.000Z"
            },
            "expected_status": 201,
            "validation_rules": [
              "Task is created successfully",
              "Task is assigned to specified user",
              "Assignee belongs to same organization",
              "Manager can assign tasks to team members"
            ],
            "save_variables": {
              "admin_task_id": "response.task.id"
            }
          },
          {
            "test_id": "ADMIN_TASK_03",
            "name": "Cannot Assign Task to User from Different Organization",
            "method": "POST",
            "endpoint": "/admin/tasks",
            "authentication": "bearer",
            "token_variable": "acme_manager_token",
            "request_body": {
              "title": "Cross-org task",
              "assigneeId": "{tech_manager_id}",
              "status": "TODO"
            },
            "expected_status": 400,
            "validation_rules": [
              "Returns 400 Bad Request",
              "Error indicates assignee from different organization",
              "Cannot assign tasks across organizations"
            ]
          },
          {
            "test_id": "ADMIN_TASK_04",
            "name": "Update Any Task in Organization",
            "method": "PATCH",
            "endpoint": "/admin/tasks/{admin_task_id}",
            "authentication": "bearer",
            "token_variable": "acme_manager_token",
            "request_body": {
              "title": "Updated by manager",
              "priority": "HIGH",
              "status": "IN_PROGRESS"
            },
            "expected_status": 200,
            "validation_rules": [
              "Task is updated successfully",
              "Manager can update any task in organization"
            ]
          },
          {
            "test_id": "ADMIN_TASK_05",
            "name": "Delete Any Task in Organization",
            "method": "DELETE",
            "endpoint": "/admin/tasks/{admin_task_id}",
            "authentication": "bearer",
            "token_variable": "acme_manager_token",
            "expected_status": 200,
            "validation_rules": [
              "Task is deleted successfully",
              "Manager can delete any task in organization"
            ]
          },
          {
            "test_id": "ADMIN_TASK_06",
            "name": "Member Cannot Access Admin Task Endpoints",
            "method": "GET",
            "endpoint": "/admin/tasks",
            "authentication": "bearer",
            "token_variable": "acme_member_token",
            "expected_status": 403,
            "validation_rules": [
              "Returns 403 Forbidden",
              "Members cannot access admin endpoints"
            ]
          }
        ]
      },
      {
        "category": "8. Authorization & Security",
        "priority": "CRITICAL",
        "description": "Test role-based access control, organization isolation, and security features",
        "tests": [
          {
            "test_id": "SEC_01",
            "name": "Access Protected Endpoint Without Token",
            "method": "GET",
            "endpoint": "/tasks/view?scope=my_active",
            "authentication": "none",
            "expected_status": 401,
            "validation_rules": [
              "Returns 401 Unauthorized",
              "Error indicates missing authentication"
            ]
          },
          {
            "test_id": "SEC_02",
            "name": "Access with Invalid Token",
            "method": "GET",
            "endpoint": "/tasks/view?scope=my_active",
            "authentication": "bearer",
            "token": "invalid.jwt.token",
            "expected_status": 401,
            "validation_rules": [
              "Returns 401 Unauthorized",
              "Error indicates invalid token"
            ]
          },
          {
            "test_id": "SEC_03",
            "name": "Access with Expired Token",
            "method": "GET",
            "endpoint": "/tasks/view?scope=my_active",
            "authentication": "bearer",
            "token": "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1c2VySWQiOiIxMjMiLCJleHAiOjE2MDAwMDAwMDB9.xxx",
            "expected_status": 401,
            "validation_rules": [
              "Returns 401 Unauthorized",
              "Error indicates expired token"
            ]
          },
          {
            "test_id": "SEC_04",
            "name": "Cross-Organization Resource Access - Tasks",
            "method": "GET",
            "endpoint": "/admin/tasks/{admin_task_id}",
            "authentication": "bearer",
            "token_variable": "tech_manager_token",
            "expected_status": 404,
            "validation_rules": [
              "Returns 404 Not Found",
              "ensureOrganizationAccess middleware prevents access",
              "No data leakage between organizations"
            ]
          },
          {
            "test_id": "SEC_05",
            "name": "Rate Limiting Test",
            "method": "GET",
            "endpoint": "/health",
            "authentication": "none",
            "iterations": 101,
            "expected_status": 429,
            "validation_rules": [
              "Returns 429 Too Many Requests after 100 requests",
              "Rate limit is enforced (100 requests per 15 minutes)",
              "Error message indicates rate limit exceeded"
            ]
          },
          {
            "test_id": "SEC_06",
            "name": "SQL Injection Prevention - Login",
            "method": "POST",
            "endpoint": "/auth/login",
            "request_body": {
              "usernameOrEmail": "admin' OR '1'='1",
              "password": "anything"
            },
            "expected_status": 401,
            "validation_rules": [
              "Returns 401 Unauthorized",
              "SQL injection is prevented",
              "Prisma ORM parameterizes queries"
            ]
          },
          {
            "test_id": "SEC_07",
            "name": "Password Not Returned in Responses",
            "method": "GET",
            "endpoint": "/users",
            "authentication": "bearer",
            "token_variable": "acme_manager_token",
            "expected_status": 200,
            "validation_rules": [
              "Response does not contain passwordHash field",
              "Password is never exposed in API responses"
            ]
          },
          {
            "test_id": "SEC_08",
            "name": "Deactivated User Cannot Login",
            "method": "POST",
            "endpoint": "/auth/login",
            "request_body": {
              "usernameOrEmail": "{deactivated_user_email}",
              "password": "password123"
            },
            "expected_status": 401,
            "validation_rules": [
              "Returns 401 Unauthorized",
              "Inactive users cannot authenticate"
            ]
          },
          {
            "test_id": "SEC_09",
            "name": "Inactive Organization Cannot Login",
            "method": "POST",
            "endpoint": "/auth/login",
            "request_body": {
              "usernameOrEmail": "{user_from_inactive_org_email}",
              "password": "password123"
            },
            "expected_status": 403,
            "validation_rules": [
              "Returns 403 Forbidden",
              "Users from inactive organizations cannot login",
              "Error indicates organization is inactive"
            ]
          },
          {
            "test_id": "SEC_10",
            "name": "CORS Headers Present",
            "method": "OPTIONS",
            "endpoint": "/health",
            "headers": {
              "Origin": "http://localhost:8080",
              "Access-Control-Request-Method": "GET"
            },
            "expected_status": 204,
            "validation_rules": [
              "Returns CORS headers",
              "Access-Control-Allow-Origin is present",
              "CORS is configured for allowed origins"
            ]
          },
          {
            "test_id": "SEC_11",
            "name": "Helmet Security Headers",
            "method": "GET",
            "endpoint": "/health",
            "expected_status": 200,
            "validation_rules": [
              "Response contains X-Content-Type-Options: nosniff",
              "Response contains X-Frame-Options",
              "Response contains X-XSS-Protection",
              "Security headers are set by Helmet"
            ]
          }
        ]
      },
      {
        "category": "9. Data Validation & Error Handling",
        "priority": "MEDIUM",
        "description": "Test input validation, error responses, and edge cases",
        "tests": [
          {
            "test_id": "VAL_01",
            "name": "Create Task with Missing Required Fields",
            "method": "POST",
            "endpoint": "/tasks",
            "authentication": "bearer",
            "token_variable": "acme_member_token",
            "request_body": {
              "note": "Missing title field"
            },
            "expected_status": 400,
            "validation_rules": [
              "Returns 400 Bad Request",
              "Error message indicates missing title",
              "Zod validation is working"
            ]
          },
          {
            "test_id": "VAL_02",
            "name": "Create Task with Invalid Status",
            "method": "POST",
            "endpoint": "/tasks",
            "authentication": "bearer",
            "token_variable": "acme_member_token",
            "request_body": {
              "title": "Test task",
              "status": "INVALID_STATUS"
            },
            "expected_status": 400,
            "validation_rules": [
              "Returns 400 Bad Request",
              "Error indicates invalid status value",
              "Valid statuses are: TODO, IN_PROGRESS, DONE"
            ]
          },
          {
            "test_id": "VAL_03",
            "name": "Create Task with Invalid Priority",
            "method": "POST",
            "endpoint": "/tasks",
            "authentication": "bearer",
            "token_variable": "acme_member_token",
            "request_body": {
              "title": "Test task",
              "priority": "INVALID_PRIORITY"
            },
            "expected_status": 400,
            "validation_rules": [
              "Returns 400 Bad Request",
              "Error indicates invalid priority value",
              "Valid priorities are: LOW, NORMAL, HIGH"
            ]
          },
          {
            "test_id": "VAL_04",
            "name": "Create User with Invalid Email",
            "method": "POST",
            "endpoint": "/users",
            "authentication": "bearer",
            "token_variable": "acme_manager_token",
            "request_body": {
              "name": "Test User",
              "username": "testuser",
              "email": "invalid-email",
              "password": "password123",
              "role": "MEMBER"
            },
            "expected_status": 400,
            "validation_rules": [
              "Returns 400 Bad Request",
              "Error indicates invalid email format"
            ]
          },
          {
            "test_id": "VAL_05",
            "name": "Create User with Duplicate Username in Same Org",
            "method": "POST",
            "endpoint": "/users",
            "authentication": "bearer",
            "token_variable": "acme_manager_token",
            "request_body": {
              "name": "Duplicate User",
              "username": "alice",
              "email": "different@acme.com",
              "password": "password123",
              "role": "MEMBER"
            },
            "expected_status": 400,
            "validation_rules": [
              "Returns 400 Bad Request",
              "Error indicates username already exists in organization"
            ]
          },
          {
            "test_id": "VAL_06",
            "name": "Invalid Query Parameter",
            "method": "GET",
            "endpoint": "/tasks/view?scope=invalid_scope",
            "authentication": "bearer",
            "token_variable": "acme_member_token",
            "expected_status": 400,
            "validation_rules": [
              "Returns 400 Bad Request",
              "Error indicates invalid scope parameter",
              "Valid scopes are: my_active, team_active, my_done"
            ]
          },
          {
            "test_id": "VAL_07",
            "name": "Access Non-existent Resource",
            "method": "GET",
            "endpoint": "/tasks/00000000-0000-0000-0000-000000000000",
            "authentication": "bearer",
            "token_variable": "acme_member_token",
            "expected_status": 404,
            "validation_rules": [
              "Returns 404 Not Found",
              "Error message is clear and informative"
            ]
          },
          {
            "test_id": "VAL_08",
            "name": "Invalid UUID Format",
            "method": "GET",
            "endpoint": "/tasks/not-a-uuid",
            "authentication": "bearer",
            "token_variable": "acme_member_token",
            "expected_status": 400,
            "validation_rules": [
              "Returns 400 Bad Request",
              "Error indicates invalid UUID format"
            ]
          },
          {
            "test_id": "VAL_09",
            "name": "Create Task with Invalid Date Format",
            "method": "POST",
            "endpoint": "/tasks",
            "authentication": "bearer",
            "token_variable": "acme_member_token",
            "request_body": {
              "title": "Test task",
              "dueDate": "not-a-date"
            },
            "expected_status": 400,
            "validation_rules": [
              "Returns 400 Bad Request",
              "Error indicates invalid date format",
              "Date should be ISO 8601 format"
            ]
          },
          {
            "test_id": "VAL_10",
            "name": "404 for Non-existent Route",
            "method": "GET",
            "endpoint": "/nonexistent/route",
            "authentication": "bearer",
            "token_variable": "acme_member_token",
            "expected_status": 404,
            "validation_rules": [
              "Returns 404 Not Found",
              "Error message indicates route not found"
            ]
          }
        ]
      },
      {
        "category": "10. Performance & Edge Cases",
        "priority": "LOW",
        "description": "Test performance, pagination, and edge cases",
        "tests": [
          {
            "test_id": "PERF_01",
            "name": "Large Task List Performance",
            "method": "GET",
            "endpoint": "/admin/tasks",
            "authentication": "bearer",
            "token_variable": "acme_manager_token",
            "expected_status": 200,
            "validation_rules": [
              "Response time < 1000ms",
              "Database queries are optimized",
              "Includes related data (topics, assignees) efficiently"
            ]
          },
          {
            "test_id": "PERF_02",
            "name": "Concurrent Requests Test",
            "description": "Send 10 concurrent requests to test race conditions",
            "method": "GET",
            "endpoint": "/tasks/view?scope=my_active",
            "authentication": "bearer",
            "token_variable": "acme_member_token",
            "concurrent_requests": 10,
            "expected_status": 200,
            "validation_rules": [
              "All requests succeed",
              "No database locking issues",
              "Responses are consistent"
            ]
          },
          {
            "test_id": "EDGE_01",
            "name": "Create Task with Minimal Data",
            "method": "POST",
            "endpoint": "/tasks",
            "authentication": "bearer",
            "token_variable": "acme_member_token",
            "request_body": {
              "title": "Minimal task"
            },
            "expected_status": 201,
            "validation_rules": [
              "Task is created with only title",
              "Optional fields have default values",
              "status defaults to TODO",
              "priority defaults to NORMAL"
            ]
          },
          {
            "test_id": "EDGE_02",
            "name": "Create Task with Very Long Title",
            "method": "POST",
            "endpoint": "/tasks",
            "authentication": "bearer",
            "token_variable": "acme_member_token",
            "request_body": {
              "title": "A".repeat(500)
            },
            "expected_status": "400 or 201",
            "validation_rules": [
              "Either accepts long title or returns validation error",
              "No server crash or unhandled error"
            ]
          },
          {
            "test_id": "EDGE_03",
            "name": "Update Task with Empty String",
            "method": "PATCH",
            "endpoint": "/tasks/{member_task_id}",
            "authentication": "bearer",
            "token_variable": "acme_member_token",
            "request_body": {
              "title": ""
            },
            "expected_status": 400,
            "validation_rules": [
              "Returns 400 Bad Request",
              "Title cannot be empty string"
            ]
          },
          {
            "test_id": "EDGE_04",
            "name": "Create Task without Topic",
            "method": "POST",
            "endpoint": "/tasks",
            "authentication": "bearer",
            "token_variable": "acme_member_token",
            "request_body": {
              "title": "Uncategorized task"
            },
            "expected_status": 201,
            "validation_rules": [
              "Task is created successfully",
              "topicId is null",
              "Task can exist without topic"
            ]
          },
          {
            "test_id": "EDGE_05",
            "name": "Task Status Transition Validation",
            "method": "PATCH",
            "endpoint": "/tasks/{member_task_id}/status",
            "authentication": "bearer",
            "token_variable": "acme_member_token",
            "request_body": {
              "status": "TODO"
            },
            "expected_status": 200,
            "validation_rules": [
              "Can transition from any status to TODO",
              "Status updates are flexible"
            ]
          }
        ]
      }
    ],
    "test_execution_guidelines": {
      "order": "Execute tests in category order (1-10)",
      "dependencies": "Some tests depend on previous tests (e.g., updating tasks requires creating them first)",
      "variable_substitution": "Replace {variable_name} with saved values from previous tests",
      "authentication": "Store tokens from login tests and reuse in authenticated requests",
      "cleanup": "Consider resetting database between test runs for consistency",
      "error_handling": "Document all error responses for debugging"
    },
    "success_criteria": {
      "health_check": "Server is running and database is connected",
      "authentication": "All user roles can login and receive valid JWT tokens",
      "authorization": "Role-based access control is enforced correctly",
      "organization_isolation": "Users cannot access data from other organizations",
      "crud_operations": "All CRUD operations work for tasks, users, and topics",
      "data_validation": "Invalid inputs are rejected with appropriate error messages",
      "security": "Security features (rate limiting, CORS, headers) are active",
      "guest_permissions": "Guest users see only limited data as configured",
      "user_limits": "Organization user limit (15) is enforced",
      "error_handling": "All errors return proper HTTP status codes and messages"
    },
    "additional_notes": {
      "multi_tenant_architecture": "The system uses organization-scoped data with strict isolation between tenants",
      "role_hierarchy": "ADMIN > TEAM_MANAGER > MEMBER > GUEST",
      "guest_restrictions": "Guests have read-only access to specific topics and see filtered task fields",
      "team_manager_restrictions": "Cannot create ADMIN or other TEAM_MANAGER users, can only manage their organization",
      "soft_delete": "Users are deactivated (soft delete) rather than hard deleted",
      "jwt_expiry": "Tokens expire after 7 days (configurable)",
      "database": "Uses Prisma ORM with SQLite in development, supports PostgreSQL/MySQL for production",
      "api_versioning": "No versioning currently implemented",
      "documentation": "See server/README.md and server/MULTI_TENANT_COMPLETION_SUMMARY.md for detailed documentation"
    }
  }
}
